---
title: "Correlations"
author: "Hans Martin"
date: "11/21/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(AirFireModeling)
library(PWFSLSmoke)
library(ggplot2)
library(raster)
library(rasterVis)
```

# Pick a location
```{r}
all_monitors <- monitor_load(20191115, 20191117)
monitor_leaflet(all_monitors)
```

```{r}
# Create California Raster from monitor
ca_monitors <- all_monitors %>% monitor_subset(stateCodes = 'CA')

# Load bluesky rasters
setModelDataDir('~/Data/Bluesky')
bs_raster <- bluesky_load(
  model = "CANSAC-4km",
  modelRun = 2019111500
)

ca_raster <- monitor_toRaster(
  ws_monitor = ca_monitors, 
  raster = bs_raster
)
```

```{r}
# Looking at the 12th hour
raster_map(ca_raster[[12]], palette = 'Spectral')
```
```{r}
raster_map(bs_raster[[12]], palette = 'Spectral')
```

```{r}
corr <- raster_correlation(ca_raster[[12]], bs_raster[[12]], res = 0.25, plot = T)
```

```{r}
raster_map(cor, 'Greens')
```

